<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Laporan Kehadiran - OCS NFI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f4f4f8;
    padding: 20px;
    max-width: 600px;
    margin: auto;
  }

  h2 {
    text-align: center;
    color: #333;
  }

  label {
    display: block;
    margin-top: 20px;
    font-weight: 600;
  }

  input, select, textarea {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }

  button {
    padding: 12px;
    width: 100%;
    background: #5a00d6;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    margin-top: 15px;
    cursor: pointer;
  }

  .btn-popup {
    background: #0073ff;
    margin-top: 10px;
  }

  textarea {
    height: 200px;
    resize: none;
  }

  /* ========================= */
  /*         POPUP MODAL       */
  /* ========================= */
  .modal {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.45);
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    width: 90%;
    max-width: 450px;
    background: white;
    border-radius: 12px;
    padding: 20px;
    max-height: 80%;
    overflow-y: auto;
  }

  .modal-content h3 {
    text-align: center;
    margin-bottom: 10px;
  }

  .karyawan-item {
    padding: 10px;
    border-bottom: 1px solid #eee;
  }

  .modal button {
    margin-top: 15px;
  }
</style>
</head>
<body>

<h2>Laporan Kehadiran OCS NFI</h2>

<label>Salam</label>
<select id="salam">
  <option>Selamat pagi</option>
  <option>Selamat siang</option>
  <option>Selamat malam</option>
</select>

<label>Tanggal</label>
<input type="date" id="tanggal">

<label>Shift</label>
<select id="shift">
  <option>Shift pagi (07.00â€“15.00)</option>
  <option>Shift siang (13.00â€“18.00)</option>
  <option>Shift malam (22.00â€“06.00)</option>
</select>

<!-- ===================== -->
<!--   BUTTON POPUP LIST   -->
<!-- ===================== -->

<label>Karyawan Hadir</label>
<button class="btn-popup" onclick="openPopup('hadir')">Pilih Karyawan Hadir</button>

<label>Karyawan Izin</label>
<button class="btn-popup" onclick="openPopup('izin')">Pilih Karyawan Izin</button>

<label>Karyawan Sakit</label>
<button class="btn-popup" onclick="openPopup('sakit')">Pilih Karyawan Sakit</button>

<label>Karyawan Alpa</label>
<button class="btn-popup" onclick="openPopup('alpa')">Pilih Karyawan Alpa</button>

<label>Catatan (Opsional)</label>
<input type="text" id="catatan" placeholder="Isi catatan tambahan...">

<label>Hasil</label>
<textarea id="hasil" readonly></textarea>

<button onclick="generate()">Salin ke Clipboard</button>

<!-- ===================== -->
<!--       POPUP MODAL     -->
<!-- ===================== -->

<div class="modal" id="modal">
  <div class="modal-content">
    <h3 id="modal-title">Pilih Karyawan</h3>
    <div id="modal-list"></div>
    <button onclick="saveSelection()">Simpan</button>
    <button style="background:#999" onclick="closePopup()">Batal</button>
  </div>
</div>

<script>
const karyawan = [
  { nama: "Pohara Ayub", area: "Team Leader" },
  { nama: "Sadulloh", area: "Team Leader" },
  { nama: "Saiful Bahri", area: "Office Lantai 1" },
  { nama: "Siti Maemunah", area: "Office Lantai 2" },
  { nama: "Sulaiman", area: "Office Jakarta" },
  { nama: "Wahidin", area: "Gardener" },
  { nama: "Edi Ahmad Jubaedi", area: "Produksi" },
  { nama: "Ade Surahman", area: "Produksi" },
  { nama: "Muhammad Toni", area: "Produksi" },
  { nama: "M. Rifai", area: "Produksi" },
  { nama: "Amrullah", area: "Warehouse 1 & 2" },
  { nama: "Amrullah", area: "Warehouse 1" },
  { nama: "Nabrih", area: "Member Pembersihan Pallet Warehouse Tepung" }
];

let activeCategory = "";
const selections = { hadir: [], izin: [], sakit: [], alpa: [] };

function openPopup(category) {
  activeCategory = category;
  document.getElementById("modal").style.display = "flex";
  document.getElementById("modal-title").innerText = "Pilih Karyawan " + category.toUpperCase();

  const listDiv = document.getElementById("modal-list");
  listDiv.innerHTML = "";

  karyawan.forEach(k => {
    const id = `${category}-${k.nama}`;

    listDiv.innerHTML += `
      <div class="karyawan-item">
        <input type="checkbox" id="${id}" value="${k.nama} (${k.area})"
        ${ selections[category].includes(`${k.nama} (${k.area})`) ? "checked" : "" }>
        <label for="${id}">${k.nama} (${k.area})</label>
      </div>
    `;
  });
}

function saveSelection() {
  const checkboxes = document.querySelectorAll(`#modal-list input[type='checkbox']`);

  selections[activeCategory] = [];

  checkboxes.forEach(cb => {
    if (cb.checked) selections[activeCategory].push(cb.value);
  });

  closePopup();
}

function closePopup() {
  document.getElementById("modal").style.display = "none";
}

function formatTanggal(dateStr) {
  const hari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
  const bulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
  const d = new Date(dateStr);
  return `${hari[d.getDay()]}, ${d.getDate()} ${bulan[d.getMonth()]} ${d.getFullYear()}`;
}

function formatList(arr) {
  return arr.length ? "\n- " + arr.join("\n- ") : "-";
}

function generate() {
  const salam = document.getElementById("salam").value;
  const tanggal = document.getElementById("tanggal").value;
  if (!tanggal) return alert("Pilih tanggal terlebih dahulu!");

  const hasil = `
${salam}

ðŸ“‹ Laporan Kehadiran Member OCS NFI
ðŸ“… Hari/Tanggal: ${formatTanggal(tanggal)}
ðŸ•’ Shift: ${document.getElementById("shift").value}

âœ… Hadir (${selections.hadir.length}):${formatList(selections.hadir)}
ðŸ“ Izin:${formatList(selections.izin)}
ðŸ¤’ Sakit:${formatList(selections.sakit)}
âŒ Alpa:${formatList(selections.alpa)}

${document.getElementById("catatan").value ? "âœï¸ Catatan: " + document.getElementById("catatan").value : ""}
    
Demikian, Terima kasih ðŸ™`;

  document.getElementById("hasil").value = hasil;
  navigator.clipboard.writeText(hasil);
  alert("Berhasil disalin ke clipboard!");
}

document.addEventListener("DOMContentLoaded", () => {
  const today = new Date().toISOString().split("T")[0];
  document.getElementById("tanggal").value = today;
});
</script>

</body>
</html>