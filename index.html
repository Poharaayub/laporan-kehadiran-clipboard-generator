<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Laporan Kehadiran - OCS NFI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<style>
  /* ========================= */
  /* M3 DARK PURPLE THEME   */
  /* ========================= */
  :root {
    --bg-color: #1c1b1f;
    --surface-color: #2b2930;
    --primary-color: #d0bcff;
    --on-primary: #381e72;
    --secondary-container: #4a4458;
    --on-secondary-container: #e8def8;
    --text-main: #e6e1e5;
    --text-dim: #938f99;
    --border-color: #49454f;
    --whatsapp-green: #25d366;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background: var(--bg-color);
    color: var(--text-main);
    padding: 20px;
    max-width: 600px;
    margin: auto;
    line-height: 1.5;
  }

  h2 {
    text-align: center;
    margin-bottom: 24px;
    color: var(--primary-color);
    letter-spacing: 0.5px;
  }

  label {
    display: block;
    margin-top: 18px;
    font-size: 14px;
    font-weight: 500;
    color: var(--primary-color);
    margin-left: 4px;
  }

  input, select, textarea {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    background: var(--surface-color);
    color: var(--text-main);
    font-size: 16px;
    margin-top: 6px;
    transition: border-color 0.3s;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--primary-color);
  }

  .btn-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 10px;
  }

  button {
    width: 100%;
    padding: 12px;
    border-radius: 25px;
    border: none;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    margin-top: 10px;
  }

  .btn-wa {
    background: var(--whatsapp-green);
    color: white;
    margin-top: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .btn-wa:active {
    transform: scale(0.98);
    opacity: 0.9;
  }

  .btn-status {
    background: var(--secondary-container);
    color: var(--on-secondary-container);
    margin-top: 0;
    border: 1px solid var(--border-color);
    text-align: left;
    padding-left: 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-right: 15px;
  }

  .badge-count {
    background: var(--primary-color);
    color: var(--on-primary);
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 12px;
    font-weight: bold;
  }

  textarea {
    height: 180px;
    font-family: monospace;
    font-size: 14px;
    background: #121212;
    resize: none;
  }

  /* MODAL */
  .modal {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    justify-content: center;
    align-items: center;
    padding: 15px;
    backdrop-filter: blur(4px);
  }

  .modal-content {
    width: 100%;
    max-width: 450px;
    background: var(--surface-color);
    border-radius: 24px;
    padding: 24px;
    max-height: 85%;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
  }

  #modal-list {
    margin-bottom: 20px;
  }

  .karyawan-item {
    padding: 12px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
  }

  .karyawan-item:hover {
    background: rgba(255,255,255,0.05);
  }

  .karyawan-item input[type="checkbox"] {
    width: 22px;
    height: 22px;
    accent-color: var(--primary-color);
    margin-right: 12px;
    pointer-events: none; 
  }

  .karyawan-item label {
    margin: 0;
    font-weight: normal;
    color: var(--text-main);
    flex: 1;
    cursor: pointer;
  }

  .btn-done {
    background: var(--primary-color);
    color: var(--on-primary);
  }
</style>
</head>
<body>

<h2>Laporan OCS NFI</h2>

<label>Salam Pembuka</label>
<select id="salam">
  <option>Selamat pagi</option>
  <option>Selamat siang</option>
  <option>Selamat malam</option>
</select>

<label>Pilih Tanggal</label>
<input type="date" id="tanggal">

<label>Waktu Shift</label>
<select id="shift">
  <option>Shift pagi (07.00‚Äì15.00)</option>
  <option>Shift siang (13.00‚Äì18.00)</option>
  <option>Shift malam (22.00‚Äì06.00)</option>
</select>

<label>Data Kehadiran</label>
<div class="btn-grid">
    <button class="btn-status" onclick="openPopup('hadir')">üìã Hadir <span class="badge-count" id="count-hadir">0</span></button>
    <button class="btn-status" onclick="openPopup('izin')">‚úâÔ∏è Izin <span class="badge-count" id="count-izin">0</span></button>
    <button class="btn-status" onclick="openPopup('sakit')">ü§í Sakit <span class="badge-count" id="count-sakit">0</span></button>
    <button class="btn-status" onclick="openPopup('alpa')">üö´ Alpa <span class="badge-count" id="count-alpa">0</span></button>
    <button class="btn-status" style="grid-column: span 2" onclick="openPopup('off')">üè† Libur / OFF <span class="badge-count" id="count-off">0</span></button>
</div>

<label>Catatan Tambahan</label>
<input type="text" id="catatan" placeholder="Ketik catatan di sini..." autocomplete="off">

<label>Pratinjau Laporan</label>
<textarea id="hasil" readonly></textarea>

<button class="btn-wa" onclick="sendToWhatsApp()">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
    <path d="M12.031 6.172c-3.181 0-5.767 2.586-5.768 5.766-.001 1.298.38 2.27 1.019 3.287l-.582 2.128 2.182-.573c.978.58 1.911.928 3.145.929 3.178 0 5.767-2.587 5.768-5.766 0-3.18-2.587-5.771-5.764-5.771zm3.392 8.244c-.144.405-.837.774-1.17.824-.299.045-.677.063-1.092-.069-.252-.08-.575-.187-.988-.365-1.739-.751-2.874-2.502-2.961-2.617-.087-.116-.708-.94-.708-1.793 0-.853.448-1.273.607-1.446.159-.173.346-.217.462-.217l.332.006c.106.005.249-.04.39.298.144.347.491 1.2.534 1.287.043.087.072.188.014.304-.058.116-.087.188-.173.289l-.26.304c-.087.101-.177.211-.077.383.1.173.444.735.95 1.185.65.579 1.2.76 1.373.846.173.087.275.072.376-.043.101-.116.434-.506.549-.68.116-.173.231-.144.39-.087.158.058 1.011.477 1.184.564.173.087.289.129.332.202.043.073.043.423-.101.827zM12.003 2c-5.522 0-9.997 4.477-9.997 10 0 1.764.459 3.419 1.263 4.858L2 22l5.285-1.388c1.4.78 3.003 1.229 4.711 1.229 5.522 0 10-4.477 10-10 0-5.522-4.478-10-9.997-10z"/>
  </svg>
  Kirim ke WhatsApp
</button>

<div id="toast" class="custom-alert">Laporan disalin!</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h3 id="modal-title" style="text-align:center; color:var(--primary-color); margin-bottom:15px;">Pilih Karyawan</h3>
    <div id="modal-list"></div>
    <div style="margin-top:auto;">
        <button class="btn-done" onclick="closePopup()">Selesai</button>
    </div>
  </div>
</div>

<script>
const karyawanList = [
  { nama: "Pohara Ayub", area: "Team Leader" },
  { nama: "Sadulloh", area: "Team Leader" },
  { nama: "Saiful Bahri", area: "Office Lantai 1" },
  { nama: "Siti Maemunah", area: "Office Lantai 2" },
  { nama: "Sulaiman", area: "Office Jakarta" },
  { nama: "Wahidin", area: "Gardener" },
  { nama: "Edi Ahmad Jubaedi", area: "Produksi" },
  { nama: "Ade Surahman", area: "Produksi" },
  { nama: "Muhammad Toni", area: "Produksi" },
  { nama: "M. Rifai", area: "Produksi" },
  { nama: "Amrullah", area: "Warehouse 1 & 2" },
  { nama: "Nabrih", area: "Pembersihan Pallet" }
];

let activeCategory = "";
const selections = { hadir: [], izin: [], sakit: [], alpa: [], off: [] };

function openPopup(category) {
  activeCategory = category;
  const modal = document.getElementById("modal");
  const titles = { hadir: "HADIR", izin: "IZIN", sakit: "SAKIT", alpa: "ALPA", off: "OFF" };
  document.getElementById("modal-title").innerText = "DATA " + titles[category];
  
  renderList();
  modal.style.display = "flex";
}

function renderList() {
  const listDiv = document.getElementById("modal-list");
  listDiv.innerHTML = "";
  
  karyawanList.forEach((k, index) => {
    const val = `${k.nama} (${k.area})`;
    const isChecked = selections[activeCategory].includes(val);
    
    const item = document.createElement("div");
    item.className = "karyawan-item";
    item.innerHTML = `
      <input type="checkbox" id="cb-${index}" ${isChecked ? "checked" : ""}>
      <label>${k.nama} <br><small style="color:var(--text-dim)">${k.area}</small></label>
    `;
    
    item.onclick = () => {
        const checkbox = item.querySelector('input');
        checkbox.checked = !checkbox.checked;
        handleCheckChange(val, checkbox.checked);
    };
    
    listDiv.appendChild(item);
  });
}

function handleCheckChange(value, isChecked) {
    if (isChecked) {
        if (!selections[activeCategory].includes(value)) {
            selections[activeCategory].push(value);
        }
    } else {
        selections[activeCategory] = selections[activeCategory].filter(v => v !== value);
    }
    updateBadgeCounts();
    updatePreview();
}

function updateBadgeCounts() {
    for (const cat in selections) {
        document.getElementById(`count-${cat}`).innerText = selections[cat].length;
    }
}

function closePopup() { 
    document.getElementById("modal").style.display = "none"; 
}

function formatTanggal(dateStr) {
  const d = new Date(dateStr);
  if(isNaN(d.getTime())) return "-";
  const hari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
  const bulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
  return `${hari[d.getDay()]}, ${d.getDate()} ${bulan[d.getMonth()]} ${d.getFullYear()}`;
}

function formatList(arr) {
  return arr.length ? "\n- " + arr.join("\n- ") : " -";
}

function updatePreview() {
    const salam = document.getElementById("salam").value;
    const tanggal = document.getElementById("tanggal").value;
    const shift = document.getElementById("shift").value;
    const catatan = document.getElementById("catatan").value;

    const hasil = `${salam},

üìã LAPORAN KEHADIRAN MEMBER OCS NFI
----------------------------------
üìÖ Tanggal : ${formatTanggal(tanggal)}
üïí Shift   : ${shift}

‚úÖ HADIR (${selections.hadir.length}):${formatList(selections.hadir)}

‚úâÔ∏è IZIN   :${formatList(selections.izin)}
ü§í SAKIT  :${formatList(selections.sakit)}
üö´ ALPA   :${formatList(selections.alpa)}
üè† OFF    :${formatList(selections.off)}

${catatan.trim() ? "üìù CATATAN: " + catatan + "\n" : ""}
Demikian laporan ini disampaikan. Terima kasih.`;

    document.getElementById("hasil").value = hasil;
}

function sendToWhatsApp() {
    const text = document.getElementById("hasil").value;
    const url = "https://api.whatsapp.com/send?text=" + encodeURIComponent(text);
    window.open(url, "_blank");
}

document.addEventListener("DOMContentLoaded", () => {
  const tglInput = document.getElementById("tanggal");
  tglInput.value = new Date().toISOString().split("T")[0];
  
  const ids = ["salam", "tanggal", "shift", "catatan"];
  ids.forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener("input", updatePreview);
  });
  
  updatePreview();
});
</script>
</body>
</html>

